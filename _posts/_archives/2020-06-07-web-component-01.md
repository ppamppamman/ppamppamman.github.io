---
layout: post
title:  "웹 컴포넌트 - 01 표준을 찾아서."
author: ppamppamman
categories: [ Dev, Javascript, WebComponent ]
image: https://user-images.githubusercontent.com/13144573/84125886-29a99b00-aa78-11ea-86e7-e312ebfde382.png
image_desc: "웹 컴포넌트" 
---

### 회사 입장에서 신입 개발자에게 기대하는 바는 무엇일까?  

개발 스택이 회사에서 운용하는 시스템과 맞고, 경력같은 신입이라면 아주 좋겠지만, 그렇지 못한 나같은 신입은 어떻게 해야할까?

## 회고  

내게 있어 표준을 이야기하기 위해서는 옛날 얘기가 들어야가 한다.  

![chanho-park](https://user-images.githubusercontent.com/13144573/83967271-ccd4a600-a8fa-11ea-8d41-9a0abb101710.jpg)

~~"제가 1994년 LA에 있을 때 일입니다"~~

이전 회사에서 아쉬웠던 것은 기술 스택의 결정을 두고 어떻게 개발할 것인가에 대한 고민이 부족했다는 점이다. 프로젝트를 앞두고 팀이 프론트엔드 스택을 결정할 때 고민했던 부분은 ``` 최소한의 교육으로 프로덕트를 빠르게 만들 수 있느냐? ```였다.  

당시 팀은 사수가 없었던 회사였기 때문에 같은 스택으로 개발을 하더라도 서로 개발에 있어 추구하는 방향이 달랐고, 이를 조절하기 위해 일정 수준의 교육이 필요했다. ```최소한의 교육```이라는 말은 그런 의미로 사용됐다. ```빠르게 만드는 것```은 돈벌이로 직결되는 프로덕트의 완성 시간이 앞당겨 질 것이라는 기대가 있었다.  

우리 팀은 Rails 백엔드 스택에 .erb로 루비코드가 마크업 파일에 바로 렌더되는 형태를 그대로 가져다 쓰고 있었고, 필요한 쿼리가 끝나야 렌더되는 환경이었기 때문에 브라우저 퍼포먼스라는 단어에 민감했다. 그랬기에 다음 프로젝트부터는 백엔드와 프론트엔드의 완전한 분리로 브라우저 퍼포먼스를 높이고자 했다. 다만 브라우저 퍼포먼스를 고려했던 것 치고 결정에 대한 고민이 부족했다고 생각한다. 

모듈화의 방법이 어떤 형태가 더 옳은지, 불변해야 하는 데이터를 각 프레임워크가 어떻게 다루는지, 테스트코드와 결합은 어떻게 진행할 것인지는 고민 대상에 들어가지 못했다.  

당시 고민되었던 내용 중 Vue.js가 높은 점수를 받았던 이유는 아래의 항목으로 정리할 수 있다. 
1.  ```<template>```기반의 마크업 코드를 그대로 가져다 쓸 수 있기에 쉽게 배울 수 있다는 점  
2. 양방향 바인딩으로 필요에 따라 데이터 가공이 쉽게 가능하다는 점

## 최근 표준에 대해 고민했던 일

퇴사 후 B회사의 프론트엔드 개발자 과제 전형에 참여하게 되었다. ~~결론부터 이야기하자면, 해당 과제 전형은 완성하지 못했다. 가정사에 큰 일이 생겼기에 집중할 환경이 되지 못했다. TMI지만, 팀 문화가 너무너무 괜찮아 보였기에 아쉬워서...~~

B 회사에서 요구했던 것은 다음과 같았다.
> 요구하는 UI를 완성하세요. 프레임워크나 라이브러리는 원하는 대로 활용하셔도 좋습니다.  

처음 과제를 받아들고, 고민은 사실 없었다.  
'아. 나는 직전까지 Vue.js에 Typescript 스택으로 개발을 했으니까, 이 스택으로 작성해야지.' 정도의 방향이 있었을 뿐. 
 
![ebichu](https://user-images.githubusercontent.com/13144573/83968978-e6301f00-a907-11ea-8a87-923745f15c77.jpeg)  
과제를 받아들고 잠들기 직전에 번뜩 이런 생각이 들었다.


> 왜 Vue를 사용하셨어요? 왜 React를 사용하셨어요?  

이런 질문에 뭐라 답해야 좋을지 판단이 서질 않았다.  

나는 이 같은 물음에 단지 ```"편해서요."```라는 답변밖에 내놓을 수 없다는 사실이 용서되지 않았다. '나는 신입개발자로서 당신들의 팀과 개발철학에 공감하고 이에 따라 합류하고 싶지만, 내 개발 스택에 대해서는 어떤 철학도 고민도 없이 단지 편해서 씁니다.'는 답변밖에 낼 수 없다는 것과 마찬가지이기 때문이다.  
 
이런 물러터진 자세로 개발을 시작할 수는 없었다.

## 다시 표준  

그럼 첫 질문으로 돌아가서 회사가 신입 개발자에게 기대하는 바는 무엇일까? 내 뇌피셜이지만 데려다 키워야 하는 사람이라면, 표준에 가장 가까운 사람을 필요로 하지 않을까? 그 중 프론트엔드 개발자에게 요구되는 표준이란 무엇일까?  

앞서 전 회사에서 고민했던 내용 중 이번 B회사의 과제에 대해 표준에 대한 내용으로 확장해서 고민할 수 있는 부분은 다음의 내용이었다.  

```모듈화의 방법은 어떤 형태가 더 옳은가```

프론트엔드 진영에서 ```모듈```에 대해 서술 할 수 있는 개념은 크게 두개 정도 있는 것 같다.

> 1. 컴포넌트
> 2. 모듈화된 코드

- 컴포넌트는 먼저 디자인패턴의 아토픽 패턴부터 이야기할 수 있다. 역할을 분할할 수 있는 정도까지 나누고 그것이 더 나뉘지 않는 일정한 의미 구조를 지닐 때 분할을 그만둔다는 것이 메인 컨셉이다. 이것이 특정 의미 단위로 묶이면 컴포넌트가 되는 것이다.
앵귤러 리액트 뷰로 대표되는 프레임워크/라이브러리에서 추구하는 컴포넌트는 크게는 파일 단위로 그 안에서는 역할단위로 분리되어 필요할 때마다 가져와서 재사용 가능해야 하며 데이터를 다루는 모델코드와 렌더하는 뷰코드가 분할 되어있고, 뷰모델코드로 엄격하게 분리된 경우 컴포넌트로 작성되었다고 말할 수 있겠다.  
- 코드의 모듈화에 대해서는 ```import 혹은 require()```정도로 이야기할 수 있겠다. ```import 대상 from 패키지``` 가 되면 ECMAscript 혹은 Typescript의 스펙이 되고, ```require(패키지)```가 되면 Node.js의 스펙이 된다.

내가 고민했던 ```모듈화```는 컴포넌트 단위가 기능 단위로 명확하여 재사용이 가능하며, 코드 충돌에 대해 걱정이 없도록 그 기능이 캡슐화되는 경우였다. 전역스코프의 오염이 없도록 코드가 모듈화 되어야 했으며 뿐만 아니라 html코드를 포함한 컴포넌트의 모듈화를 표준으로 지원하고 있어야 했다. 모듈화 해서 렌더한 경우 html 문서는 기본적으로 정적렌더링을 기준으로 하고 있기에 동적으로 변화하는 값을 추적하기가 매우 어렵다는 문제도 있었다.

이를 거의 완벽하게 지원하고 있던 것이 ```웹 컴포넌트```라 부르는 기술이었다. 나는 이런 고민의 절차를 거쳐 B회사에서의 과제전형 기간동안 웹 컴포넌트로 프로젝트를 작성하였다.  

웹 컴포넌트 기술 중 Custom Element를 구성하는 설명 내용을 옮겨 적는다.

> 커스텀 엘리먼트: 커스텀 엘리먼트와 그 동작을 정의할 수 있도록 해주는 JavaScript API 의 집합으로, 사용자 인터페이스에서 원했던대로 사용될 수 있다.

- Custom elements: 사용자 인터페이스에서 원하는대로 사용할 수있는 사용자 정의 요소 및 해당 동작을 정의 할 수있는 JavaScript API 세트이다.
- Shadow DOM: 캡슐화된 "그림자" DOM 트리를 엘리먼트 — 메인 다큐먼트 DOM 으로부터 독립적으로 렌더링 되는 — 를 추가하고 연관된 기능을 제어하기 위한 JavaScript API 의 집합. 이 방법으로 엘리먼트의 기능을 프라이빗하게 유지할 수 있어, 다큐먼트의 다른 부분과의 충돌에 대한 걱정 없이 스크립트와 스타일을 작성할 수 있다.
- HTML 템플릿: ```<template>``` 과 ```<slot>``` 엘리먼트는 렌더링된 페이지에 나타나지 않는 마크업 템플릿을 작성할 수 있게 해준다. 그 후, 커스텀 엘리먼트의 구조를 기반으로 여러 번 재사용할 수 있다.

웹 컴포넌트를 구현하기 위한 기본 접근법은 일반적으로 다음과 같다.

1. ECMAScript2015 클래스 문법(자세한 내용은 Classes에서 확인)을 사용해 웹 컴포넌트 기능을 명시하는 클래스를 생성 한다.  
2. ```CustomElementRegistry.define()``` 메소드를 사용해 새로운 커스텀 엘리먼트를 등록하고, 정의할 엘리먼트 이름, 기능을 명시하고 있는 클래스, (선택적으로) 상속받은 엘리먼트를 전달한다.  
3. 필요한 경우, ```Element.attachShadow()``` 메소드를 사용해 shadow DOM 을 커스텀 엘리먼트에 추가한다. 일반적인 DOM 메소드를 사용해 자식 엘리먼트, 이벤트 리스너 등을 shadow DOM 에 추가한다.  
4. 필요한 경우, ```<template>``` 과 ```<slot>``` 을 사용해 HTML 템플릿을 정의합니다. 다시 일반적인 DOM 메소드를 사용해 템플릿을 클론하고 shadow DOM 에 추가한다. 일반적인 HTML 엘리먼트처럼, 페이지의 원하는 어느곳이든 커스텀 엘리먼트를 사용할 수 있다.

예제 코드를 포함한 고민의 흔적은 다음 편에!

---
## 참고문헌  
[모질라 web docs - 웹 컴포넌트](https://developer.mozilla.org/ko/docs/Web/Web_Components)  
[리액트 어플리케이션 구조 - 아토믹 디자인](https://ui.toast.com/weekly-pick/ko_20200213/)